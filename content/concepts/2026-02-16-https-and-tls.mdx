---
title: "HTTPS and TLS"
slug: "2026-02-16-https-and-tls"
date: "2026-02-16"
category: "Security"
difficulty: "Intermediate"
tags: ["HTTPS", "TLS", "Encryption", "Security"]
description: "How TLS secures communication over the internet and why HTTPS is essential for every web application"
---

## Overview

HTTPS is HTTP over TLS (Transport Layer Security). TLS encrypts the connection between a client and server so that no one in between -- ISPs, Wi-Fi operators, or attackers -- can read or modify the data in transit.

Without TLS, everything sent over HTTP is in plaintext: passwords, tokens, personal data, all readable by anyone on the network path.

## The TLS Handshake

Before any application data is exchanged, the client and server perform a TLS handshake to establish an encrypted connection.

```
Client                          Server
  |                               |
  |--- ClientHello (TLS 1.3) --->|  Supported cipher suites, random
  |                               |
  |<-- ServerHello, Certificate --|  Chosen cipher, server certificate
  |    + Key Share                |  + server's public key share
  |                               |
  |--- Key Share, Finished ------>|  Client's public key share
  |                               |
  |<-- Finished ------------------|  Handshake complete
  |                               |
  |=== Encrypted Application ====|  All data is now encrypted
  |=== Data (HTTP requests) =====|
```

TLS 1.3 completes the handshake in one round trip (1-RTT), compared to two round trips in TLS 1.2.

## Certificates

A TLS certificate proves the server is who it claims to be. It's issued by a Certificate Authority (CA) that the client's browser trusts.

```bash
# Get a free certificate from Let's Encrypt
sudo certbot --nginx -d example.com -d www.example.com

# Certificate auto-renewal (runs twice daily)
sudo certbot renew --dry-run
```

### Certificate Chain

```
Root CA (trusted by browsers)
  └── Intermediate CA
        └── Your certificate (example.com)
```

The server sends its certificate plus intermediate certificates. The client verifies the chain back to a trusted root CA.

## Server Configuration

```nginx
# Nginx TLS configuration
server {
    listen 443 ssl http2;
    server_name example.com;

    ssl_certificate     /etc/letsencrypt/live/example.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/example.com/privkey.pem;

    # Modern TLS configuration
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256;
    ssl_prefer_server_ciphers off;

    # HSTS: tell browsers to always use HTTPS
    add_header Strict-Transport-Security "max-age=63072000; includeSubDomains" always;

    # Redirect HTTP to HTTPS
    error_page 497 301 =307 https://$host$request_uri;
}

server {
    listen 80;
    server_name example.com;
    return 301 https://$host$request_uri;
}
```

## HSTS (HTTP Strict Transport Security)

HSTS tells the browser to always use HTTPS for your domain, preventing protocol downgrade attacks.

```
Strict-Transport-Security: max-age=63072000; includeSubDomains; preload
```

Once a browser sees this header, it will never make an HTTP request to your domain for the specified duration, even if the user types `http://`.

## Common Pitfalls

- **Mixed content** -- Serving your page over HTTPS but loading scripts/images over HTTP. Browsers block or warn about mixed content.
- **Expired certificates** -- Causes immediate trust errors. Automate renewal with certbot or your cloud provider.
- **Not redirecting HTTP to HTTPS** -- Users who type `example.com` without `https://` get the insecure version. Always redirect.
- **TLS termination without re-encryption** -- If your load balancer terminates TLS and forwards to backends over plain HTTP inside your network, internal traffic is unencrypted.
- **Using outdated TLS versions** -- TLS 1.0 and 1.1 have known vulnerabilities. Require TLS 1.2+ minimum.

## Best Practices

- Use Let's Encrypt for free, automated certificates
- Enable HSTS with a long max-age
- Redirect all HTTP traffic to HTTPS
- Use TLS 1.3 where possible (faster handshake, stronger security)
- Test your configuration with SSL Labs (ssllabs.com/ssltest)
- Automate certificate renewal and monitor expiration
